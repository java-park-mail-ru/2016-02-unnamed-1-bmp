<html>
<head>
    <meta charset="UTF-8"/>
    <title>Game</title>
    <script type="text/javascript">
        var ws;
        var started = false;
        var finished = false;

        init = function () {
            ws = new WebSocket("ws://localhost:8080/gameplay");

            ws.onopen = function (event) {
                var message = '{"action":"set_ships", "body": { "login":"player777","four-decked": [[1, 1], [1, 2], [1, 3], [1, 4]],"three-decked": [[[2, 1], [2, 2], [2, 3]], [[3, 1], [3, 2], [3, 3]]],"two-decked": [[[4, 1], [4, 2]], [[5, 1], [5, 2]], [[6, 1], [6, 2]]], "one-decked": [[7, 1], [8, 1], [9, 1], [10, 1]] }}';
                ws.send(message);
            };

            ws.onmessage = function (event) {
                var data = JSON.parse(event.data);
                if (data.action == "start") {
                    document.getElementById("wait").style.display = "none";
                    document.getElementById("gameplay").style.display = "block";
                    document.getElementById("enemyName").innerHTML = data.body.enemyName;
                    document.getElementById("myName").innerHTML = data.body.myName;
                }
                if (data.action == "shoot") {
                    document.getElementById("shooted").innerHTML += data.body.status;
                    document.getElementById("shooted").innerHTML += " " + data.body.coordinates + " <br> ";
                }
                if (data.action == "gameOver") {
                    document.getElementById("win").innerHTML += data.body.win;
                    ws.close(1000, "GAME OVER");
                }

            };

            ws.onclose = function (event) {

            }

        };

        function sendMessagea() {
            var message = '{ "action":"shoot","body":{ "coordinates":[1,1] } }';
            ws.send(message);
        }
        function sendMessageb() {
            var message = '{ "action":"shoot","body":{ "coordinates":[1,2] } }';
            ws.send(message);
        }
        function sendMessagec() {
            var message = '{ "action":"shoot","body":{ "coordinates":[1,3] } }';
            ws.send(message);
        }
        function sendMessaged() {
            var message = '{ "action":"shoot","body":{ "coordinates":[1,4] } }';
            ws.send(message);
        }
        function sendMessagee() {
            var message = '{ "action":"shoot","body":{ "coordinates":[10,1] } }';
            ws.send(message);
        }
    </script>
</head>
<body onload="init();">
<div id="body">
    <div id="hello">
        <p>Game</p>
    </div>

    <div id="wait">
        <p>Prepare yourself. Wait for enemy!</p>
    </div>

    <div id="gameplay" style="display: none">
        <div id="score">
            <p> You are: <span id="myName"></span></p>

            <p> Your enemy: <span id="enemyName"></span></p>
        </div>

        <form name="gamePlay" action="">
            <input type="button" name="submit" value="shoot [1,1]" onclick="sendMessagea();"/>
        </form>

        <form name="gamePlay" action="">
            <input type="button" name="submit" value="shoot [1,2]" onclick="sendMessageb();"/>
        </form>

        <form name="gamePlay" action="">
            <input type="button" name="submit" value="shoot [1,3]" onclick="sendMessagec();"/>
        </form>

        <form name="gamePlay" action="">
            <input type="button" name="submit" value="shoot [1,4]" onclick="sendMessaged();"/>
        </form>

        <form name="gamePlay" action="">
            <input type="button" name="submit" value="shoot [10,1]" onclick="sendMessagee();"/>
        </form>

        <span id="shooted">
        </span>

        <span id="win">
            Have you won?:
        </span>
    </div>



</div>
</body>
</html>